import{c as qe,r as x,j as s,b as ue,t as ye,H as Ge}from"./app-pmWMUx3Z.js";import{M as Je}from"./module-heading-CrEiBD3E.js";import{A as Ke}from"./app-layout-CCdBgYU1.js";import{T as Ae,a as d,b as Qe,c as h,d as We,e as Xe}from"./table-DKfVlBHW.js";import{D as Fe,a as Oe,b as Ye,c as ze,d as Be,e as He}from"./dialog-B7cZpqle.js";import{I as Ze}from"./input-CIu_MTXg.js";import{L as es}from"./label-CLbRzDXD.js";import{T as ss}from"./textarea-_kZSorhz.js";import{B as n}from"./mainLogo-7oevAWs1.js";import{B as V}from"./badge-DeKUy4I3.js";import{c as fe,d as ge}from"./card-DZhPHigz.js";import{P as ts}from"./pagination-DERKe_cf.js";import{E as Le}from"./eye-BJPgu3Yw.js";import{C as Te}from"./check-CRr8KTL3.js";import{U as Me}from"./undo-2-1hmvRbhA.js";import{U as as}from"./user-Du9MZ_iy.js";import{S as Ie}from"./sparkles-DNj_KA3D.js";import{C as ls}from"./calendar-BE9YEtQf.js";import{A as rs}from"./index-D-LTfEee.js";import{S as is}from"./search-D5_GLBzX.js";/* empty css            */import"./x-Bs1fjyGh.js";import"./index-CGri80s-.js";import"./index-Iu80pvaU.js";import"./index-DzkkzSHD.js";import"./dropdown-menu-YpWk4hgC.js";import"./index-D6b3eXot.js";import"./store-1xSShJyq.js";import"./ticket-B1RJQtv0.js";import"./chevron-left-BitIRZNa.js";function Ms(q){const e=qe.c(108),{perkClaims:l,filters:m,stats:i}=q,[r,Ve]=x.useState(m.search||""),[a,Ne]=x.useState(null),[be,G]=x.useState(!1),[ve,ke]=x.useState(!1),[j,Ce]=x.useState(""),[o,$e]=x.useState(!1);let J;e[0]!==m.status||e[1]!==r?(J=()=>{const t=setTimeout(()=>{ue.get("/business/perk-claims",{search:r,status:m.status},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(t)},e[0]=m.status,e[1]=r,e[2]=J):J=e[2];let K;e[3]!==r?(K=[r],e[3]=r,e[4]=K):K=e[4],x.useEffect(J,K);let Q;e[5]!==r?(Q=t=>{ue.get("/business/perk-claims",{search:r,status:t},{preserveState:!0,replace:!0})},e[5]=r,e[6]=Q):Q=e[6];const c=Q,W=os;let X;e[7]===Symbol.for("react.memo_cache_sentinel")?(X=t=>{Ne(t),ke(!0)},e[7]=X):X=e[7];const Ee=X;let Y;e[8]===Symbol.for("react.memo_cache_sentinel")?(Y=t=>{Ne(t),Ce(""),G(!0)},e[8]=Y):Y=e[8];const Pe=Y;let Z;e[9]!==j||e[10]!==a?(Z=()=>{a&&($e(!0),ue.post(`/business/perk-claims/${a.id}/redeem`,{remarks:j},{onSuccess:()=>{ye.success("Perk marked as redeemed successfully!"),G(!1),Ce(""),Ne(null)},onError:ms,onFinish:()=>{$e(!1)}}))},e[9]=j,e[10]=a,e[11]=Z):Z=e[11];const we=Z,Ue=cs;let ee,se;e[12]===Symbol.for("react.memo_cache_sentinel")?(ee=s.jsx(Ge,{title:"Perk Claims"}),se=s.jsx(Je,{title:"Perk Claims",description:"View and manage customer perk claims."}),e[12]=ee,e[13]=se):(ee=e[12],se=e[13]);const Se=`cursor-pointer transition-all ${m.status?"":"ring-2 ring-black"}`;let p;e[14]!==c?(p=()=>c(""),e[14]=c,e[15]=p):p=e[15];let te;e[16]===Symbol.for("react.memo_cache_sentinel")?(te=s.jsx("p",{className:"text-sm text-gray-600",children:"Total Claims"}),e[16]=te):te=e[16];let f;e[17]!==i.total?(f=s.jsxs("div",{children:[te,s.jsx("p",{className:"text-3xl font-bold mt-1",children:i.total})]}),e[17]=i.total,e[18]=f):f=e[18];let ae;e[19]===Symbol.for("react.memo_cache_sentinel")?(ae=s.jsx(rs,{className:"w-10 h-10 text-gray-400"}),e[19]=ae):ae=e[19];let g;e[20]!==f?(g=s.jsx(ge,{className:"",children:s.jsxs("div",{className:"flex items-center justify-between",children:[f,ae]})}),e[20]=f,e[21]=g):g=e[21];let u;e[22]!==p||e[23]!==g||e[24]!==Se?(u=s.jsx(fe,{className:Se,onClick:p,children:g}),e[22]=p,e[23]=g,e[24]=Se,e[25]=u):u=e[25];const _e=`cursor-pointer transition-all ${m.status==="available"?"ring-2 ring-green-500":""}`;let y;e[26]!==c?(y=()=>c("available"),e[26]=c,e[27]=y):y=e[27];let le;e[28]===Symbol.for("react.memo_cache_sentinel")?(le=s.jsx("p",{className:"text-sm text-gray-600",children:"Available"}),e[28]=le):le=e[28];let N;e[29]!==i.available?(N=s.jsxs("div",{children:[le,s.jsx("p",{className:"text-3xl font-bold mt-1 text-green-600",children:i.available})]}),e[29]=i.available,e[30]=N):N=e[30];let re;e[31]===Symbol.for("react.memo_cache_sentinel")?(re=s.jsx(Ie,{className:"w-10 h-10 text-green-400"}),e[31]=re):re=e[31];let b;e[32]!==N?(b=s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[N,re]})}),e[32]=N,e[33]=b):b=e[33];let v;e[34]!==_e||e[35]!==y||e[36]!==b?(v=s.jsx(fe,{className:_e,onClick:y,children:b}),e[34]=_e,e[35]=y,e[36]=b,e[37]=v):v=e[37];const Re=`cursor-pointer transition-all ${m.status==="redeemed"?"ring-2 ring-gray-500":""}`;let k;e[38]!==c?(k=()=>c("redeemed"),e[38]=c,e[39]=k):k=e[39];let ie;e[40]===Symbol.for("react.memo_cache_sentinel")?(ie=s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed"}),e[40]=ie):ie=e[40];let C;e[41]!==i.redeemed?(C=s.jsxs("div",{children:[ie,s.jsx("p",{className:"text-3xl font-bold mt-1 text-gray-600",children:i.redeemed})]}),e[41]=i.redeemed,e[42]=C):C=e[42];let ce;e[43]===Symbol.for("react.memo_cache_sentinel")?(ce=s.jsx(Te,{className:"w-10 h-10 text-gray-400"}),e[43]=ce):ce=e[43];let w;e[44]!==C?(w=s.jsx(ge,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[C,ce]})}),e[44]=C,e[45]=w):w=e[45];let S;e[46]!==Re||e[47]!==k||e[48]!==w?(S=s.jsx(fe,{className:Re,onClick:k,children:w}),e[46]=Re,e[47]=k,e[48]=w,e[49]=S):S=e[49];let _;e[50]!==u||e[51]!==v||e[52]!==S?(_=s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6",children:[u,v,S]}),e[50]=u,e[51]=v,e[52]=S,e[53]=_):_=e[53];let ne;e[54]===Symbol.for("react.memo_cache_sentinel")?(ne=s.jsx(is,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e[54]=ne):ne=e[54];let de;e[55]===Symbol.for("react.memo_cache_sentinel")?(de=t=>Ve(t.target.value),e[55]=de):de=e[55];let R;e[56]!==r?(R=s.jsxs("div",{className:"mb-4 relative max-w-md",children:[ne,s.jsx(Ze,{type:"text",placeholder:"Search by customer, reward, or card...",value:r,onChange:de,className:"pl-10"})]}),e[56]=r,e[57]=R):R=e[57];let me;e[58]===Symbol.for("react.memo_cache_sentinel")?(me=s.jsx(Qe,{children:s.jsxs(Ae,{children:[s.jsx(h,{children:"Customer"}),s.jsx(h,{children:"Reward"}),s.jsx(h,{children:"Loyalty Card"}),s.jsx(h,{children:"Stamps"}),s.jsx(h,{children:"Status"}),s.jsx(h,{children:"Claimed At"}),s.jsx(h,{children:"Actions"})]})}),e[58]=me):me=e[58];let D;e[59]!==l.data?(D=l.data.length>0?l.data.map(t=>s.jsxs(Ae,{children:[s.jsx(d,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:t.customer.username}),s.jsx("div",{className:"text-xs text-gray-500",children:t.customer.email})]})}),s.jsx(d,{children:s.jsxs("div",{children:[s.jsx("div",{className:"font-medium",children:t.perk.reward}),t.perk.details&&s.jsx("div",{className:"text-xs text-gray-500",children:t.perk.details})]})}),s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[t.loyalty_card.logo&&s.jsx("img",{src:`/${t.loyalty_card.logo}`,alt:t.loyalty_card.name,className:"w-8 h-8 rounded-full object-cover"}),s.jsx("span",{children:t.loyalty_card.name})]})}),s.jsx(d,{children:t.stamps_at_claim}),s.jsx(d,{children:t.is_redeemed?s.jsx(V,{className:"bg-gray-500 hover:bg-gray-600",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500 hover:bg-green-600",children:"Available"})}),s.jsx(d,{className:"text-sm",children:W(t.created_at)}),s.jsx(d,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(n,{size:"sm",variant:"outline",onClick:()=>Ee(t),children:s.jsx(Le,{className:"w-4 h-4"})}),t.is_redeemed?s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ue(t),children:[s.jsx(Me,{className:"w-4 h-4 mr-1"}),"Undo"]}):s.jsxs(n,{size:"sm",onClick:()=>Pe(t),className:"bg-green-600 hover:bg-green-700",children:[s.jsx(Te,{className:"w-4 h-4 mr-1"}),"Redeem"]})]})})]},t.id)):s.jsx(Ae,{children:s.jsx(d,{colSpan:7,className:"text-center py-8",children:"No perk claims found."})}),e[59]=l.data,e[60]=D):D=e[60];let A;e[61]!==D?(A=s.jsx("div",{className:"hidden md:block border rounded-lg overflow-hidden",children:s.jsxs(We,{children:[me,s.jsx(Xe,{children:D})]})}),e[61]=D,e[62]=A):A=e[62];let T;e[63]!==l.data?(T=l.data.length>0?l.data.map(t=>s.jsx(fe,{children:s.jsxs(ge,{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[t.loyalty_card.logo&&s.jsx("img",{src:`/${t.loyalty_card.logo}`,alt:t.loyalty_card.name,className:"w-12 h-12 rounded-full object-cover"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:t.perk.reward}),s.jsx("div",{className:"text-sm text-gray-600",children:t.loyalty_card.name})]})]}),t.is_redeemed?s.jsx(V,{className:"bg-gray-500",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500",children:"Available"})]}),s.jsxs("div",{className:"text-sm space-y-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(as,{className:"w-4 h-4"}),s.jsx("span",{children:t.customer.username})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(Ie,{className:"w-4 h-4"}),s.jsxs("span",{children:[t.stamps_at_claim," stamps"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(ls,{className:"w-4 h-4"}),s.jsx("span",{children:W(t.created_at)})]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ee(t),className:"flex-1",children:[s.jsx(Le,{className:"w-4 h-4 mr-1"}),"Details"]}),t.is_redeemed?s.jsxs(n,{size:"sm",variant:"outline",onClick:()=>Ue(t),className:"flex-1",children:[s.jsx(Me,{className:"w-4 h-4 mr-1"}),"Undo"]}):s.jsxs(n,{size:"sm",onClick:()=>Pe(t),className:"flex-1 bg-green-600 hover:bg-green-700",children:[s.jsx(Te,{className:"w-4 h-4 mr-1"}),"Redeem"]})]})]})},t.id)):s.jsx("div",{className:"border rounded-lg p-8 text-center text-gray-500",children:"No perk claims found."}),e[63]=l.data,e[64]=T):T=e[64];let $;e[65]!==T?($=s.jsx("div",{className:"md:hidden space-y-4",children:T}),e[65]=T,e[66]=$):$=e[66];let E;e[67]!==l?(E=l.last_page>1&&s.jsx(ts,{data:l}),e[67]=l,e[68]=E):E=e[68];let P;e[69]!==R||e[70]!==A||e[71]!==$||e[72]!==E?(P=s.jsxs("div",{className:"mt-6",children:[R,A,$,E]}),e[69]=R,e[70]=A,e[71]=$,e[72]=E,e[73]=P):P=e[73];let oe;e[74]===Symbol.for("react.memo_cache_sentinel")?(oe=s.jsxs(Fe,{children:[s.jsx(Oe,{children:"Mark as Redeemed"}),s.jsx(Ye,{children:"Confirm that this perk has been redeemed by the customer."})]}),e[74]=oe):oe=e[74];let U;e[75]!==j||e[76]!==a?(U=a&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Customer:"}),s.jsx("span",{className:"font-medium",children:a.customer.username})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Reward:"}),s.jsx("span",{className:"font-medium",children:a.perk.reward})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Card:"}),s.jsx("span",{className:"font-medium",children:a.loyalty_card.name})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(es,{htmlFor:"remarks",children:"Remarks (Optional)"}),s.jsx(ss,{id:"remarks",placeholder:"Add any notes about this redemption...",value:j,onChange:t=>Ce(t.target.value),rows:3})]})]}),e[75]=j,e[76]=a,e[77]=U):U=e[77];let xe;e[78]===Symbol.for("react.memo_cache_sentinel")?(xe=()=>G(!1),e[78]=xe):xe=e[78];let F;e[79]!==o?(F=s.jsx(n,{variant:"outline",onClick:xe,disabled:o,children:"Cancel"}),e[79]=o,e[80]=F):F=e[80];const De=o?"Processing...":"Mark as Redeemed";let O;e[81]!==we||e[82]!==o||e[83]!==De?(O=s.jsx(n,{onClick:we,disabled:o,className:"bg-green-600 hover:bg-green-700",children:De}),e[81]=we,e[82]=o,e[83]=De,e[84]=O):O=e[84];let z;e[85]!==F||e[86]!==O?(z=s.jsxs(ze,{children:[F,O]}),e[85]=F,e[86]=O,e[87]=z):z=e[87];let B;e[88]!==U||e[89]!==z?(B=s.jsxs(Be,{className:"sm:max-w-md",children:[oe,U,z]}),e[88]=U,e[89]=z,e[90]=B):B=e[90];let H;e[91]!==be||e[92]!==B?(H=s.jsx(He,{open:be,onOpenChange:G,children:B}),e[91]=be,e[92]=B,e[93]=H):H=e[93];let he;e[94]===Symbol.for("react.memo_cache_sentinel")?(he=s.jsx(Fe,{children:s.jsx(Oe,{children:"Perk Claim Details"})}),e[94]=he):he=e[94];let L;e[95]!==a?(L=a&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Customer"}),s.jsx("p",{className:"font-semibold",children:a.customer.username}),s.jsx("p",{className:"text-sm text-gray-500",children:a.customer.email})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Status"}),a.is_redeemed?s.jsx(V,{className:"bg-gray-500 mt-1",children:"Redeemed"}):s.jsx(V,{className:"bg-green-500 mt-1",children:"Available"})]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Reward"}),s.jsx("p",{className:"font-semibold",children:a.perk.reward}),a.perk.details&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.perk.details})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Loyalty Card"}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.loyalty_card.logo&&s.jsx("img",{src:`/${a.loyalty_card.logo}`,alt:a.loyalty_card.name,className:"w-8 h-8 rounded-full object-cover"}),s.jsx("span",{className:"font-semibold",children:a.loyalty_card.name})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Stamps at Claim"}),s.jsx("p",{className:"font-semibold",children:a.stamps_at_claim})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Claimed At"}),s.jsx("p",{className:"font-semibold text-sm",children:W(a.created_at)})]})]}),a.is_redeemed&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed At"}),s.jsx("p",{className:"font-semibold text-sm",children:a.redeemed_at?W(a.redeemed_at):"N/A"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Redeemed By"}),s.jsx("p",{className:"font-semibold text-sm",children:a.redeemed_by?.username||"N/A"})]})]}),a.remarks&&s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Remarks"}),s.jsx("p",{className:"text-sm bg-gray-50 p-3 rounded-lg mt-1",children:a.remarks})]})]})]}),e[95]=a,e[96]=L):L=e[96];let je;e[97]===Symbol.for("react.memo_cache_sentinel")?(je=s.jsx(ze,{children:s.jsx(n,{variant:"outline",onClick:()=>ke(!1),children:"Close"})}),e[97]=je):je=e[97];let M;e[98]!==L?(M=s.jsxs(Be,{className:"sm:max-w-lg",children:[he,L,je]}),e[98]=L,e[99]=M):M=e[99];let I;e[100]!==ve||e[101]!==M?(I=s.jsx(He,{open:ve,onOpenChange:ke,children:M}),e[100]=ve,e[101]=M,e[102]=I):I=e[102];let pe;return e[103]!==_||e[104]!==P||e[105]!==H||e[106]!==I?(pe=s.jsxs(Ke,{children:[ee,se,_,P,H,I]}),e[103]=_,e[104]=P,e[105]=H,e[106]=I,e[107]=pe):pe=e[107],pe}function cs(q){confirm("Are you sure you want to undo this redemption?")&&ue.post(`/business/perk-claims/${q.id}/undo`,{},{onSuccess:ds,onError:ns})}function ns(){ye.error("Failed to undo redemption.")}function ds(){ye.success("Redemption undone successfully!")}function ms(){ye.error("Failed to mark perk as redeemed.")}function os(q){return new Date(q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}export{Ms as default};
